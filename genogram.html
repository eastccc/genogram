<!DOCTYPE html>
<html>  
  <head>  
        <meta charset="utf-8">  
        <title>demo</title>  

  </head> 
<body>
    <script src="js/svg.min.js"></script>
  <script src="js/genogram.js"></script>
  <script src="js/saveSvgAsPng.js"></script>
<div><button id="savepng">保存为图片</button></div>
<div id="genogram"></div>
<div id="png"></div>
<style type="text/css">
  #cmenu{ width: 180px;height: auto;border: 1px solid #ddd;position: absolute;z-index: 999;left: 0;top: 0;background: #fff;}
  #cmenu ul{padding: 0;margin: 0}
  #cmenu li{list-style-type: none;width: 100%;height: 30px;line-height: 30px;}
  #cmenu li a{width: 92%;padding-left: 8%; display: block; text-decoration: none;font-size: 14px;color: #000;color: #666;}
  #cmenu li a:hover{background: #eee;}
</style>

<script type="text/javascript">
var json1 = [
  [
    {
      id:'01',
      name:'尼牙孜·阿不都拉',
      fid:'',
      url:[
        {name :"去百度",url :"http://www.baidu.com/"},
        {name :"去腾讯",url :"http://www.qq.com/"},
        {name :"去知乎",url :"http://www.zhihu.com/"}
      ],
      mid:'',
      pid:'',
      cid:["11","12","13"],
      bid:["01"],
      imgurl:"img/01.jpg",
      relation:"户主",
      record : "橙色_在逃人员，红色_特殊群体"
    }
    // ,{
    //   id:'01p',
    //   name:'热依汉·热西提',
    //   fid:'',
    //   mid:'',
    //   pid:'01',
    //   cid:["11","12","13"],
    //   bid:["01p"],
    //   imgurl:"img/15.jpg",
    //   relation:"妻子",
    //   record : ""
    // }
    ],
  [
    {
      id:'11',
      name:'巴哈提古丽',
     
      fid:'01',
      mid:'01p',
      pid:'11p',
      cid:["24","25","26"],
      bid:["11","12","13","14"],
      imgurl:"img/11.jpg",
      relation:"儿子",
      record : ""
    },{
      id:'11p',
      name:'巴哈提古丽',
     
      fid:'',
      mid:'',
      pid:'11',
      cid:["24","25","26"],
      bid:["11p"],
      imgurl:"img/14.jpg",
      relation:"儿媳",
      record : "红色_特殊群体"
    },{
      id:'12',
      name:'加马力·艾买提',
     
      fid:'01',
      mid:'01p',
      pid:'',
      cid:["22"],
      bid:["11","12","13","14"],
      imgurl:"img/42.jpg",
      relation:"女儿",
      record : ""
    },

    {
      id:'13',
      name:'艾山·阿不都如',
     
      fid:'01',
      mid:'01p',
      pid:'',
      cid:[],
      bid:["11","12","13","14"],
      imgurl:"img/12.jpg",
      relation:"儿子",
      record : ""
    },{
      id:'14',
      name:'吐拉汗·吐尔迪',
     
      fid:'01',
      mid:'01p',
      pid:'14p',
      cid:["22","23"],
      bid:["11","12","13","14"],
      imgurl:"img/22.jpg",
      relation:"儿子",
      record : ""
    },{
      id:'14p',
      name:'赛比热·如则尼亚孜',
     
      fid:'',
      mid:'',
      pid:'14',
      cid:["22","23"],
      bid:["14p"],
      imgurl:"img/24.jpg",
      relation:"儿媳",
      record : ""
    }],
  [
    {
      id:'24',
      name:'努尔顿·依米拉',
     
      fid:'11',
      mid:'11p',
      pid:'',
      cid:[],
      bid:["24","25","26"],
      imgurl:"img/13.jpg",
      relation:"孙子",
      record : ""
    },{
      id:'25',
      name:'努尔顿·依米拉',
     
      fid:'11',
      mid:'11p',
      pid:'',
      cid:[],
      bid:["24","25","26"],
      imgurl:"img/43.jpg",
      relation:"孙子",
      record : ""
    },{
      id:'26',
      name:'努尔顿·依米拉',
     
      fid:'11',
      mid:'11p',
      pid:'',
      cid:[],
      bid:["24","25","26"],
      imgurl:"img/23.jpg",
      relation:"孙子",
      record : ""
    },{
      id:'21',
      name:'努尔顿·依米拉',
     
      fid:'12',
      mid:'',
      pid:'21p',
      cid:["31","31","33","34"],
      bid:["21"],
      imgurl:"img/21.jpg",
      relation:"孙子",
      record : ""
    },{
      id:'21p',
      name:'努尔顿·米拉',
     
      fid:'',
      mid:'',
      pid:'21',
      cid:["31","31","33","34"],
      bid:["21p"],
      imgurl:"img/24.jpg",
      relation:"孙媳",
      record : ""
    },{
      id:'22',
      name:'艾合麦提江',
     
      fid:'14',
      mid:'14p',
      pid:'',
      cid:[],
      bid:["22","23"],
      imgurl:"img/21.jpg",
      relation:"孙子",
      record : ""
    },{
      id:'23',
      name:'阿依乃再?麦麦提',
     
      fid:'14',
      mid:'14p',
      pid:'',
      cid:[],
      bid:["22","23"],
      imgurl:"img/21.jpg",
      relation:"孙子",
      record : ""
    }],[
    {
      id:'31',
      name:'阿依乃再?麦麦提',
     
      fid:'21',
      mid:'21p',
      pid:'',
      cid:[],
      bid:["31","32","33","34"],
      imgurl:"img/41.jpg",
      relation:"曾孙",
      record : ""
    },{
      id:'32',
      name:'阿依乃再?麦麦提',
     
      fid:'21',
      mid:'21p',
      pid:'',
      cid:[],
      bid:["31","32","33","34"],
      imgurl:"img/41.jpg",
      relation:"曾孙",
      record : ""
    },{
      id:'33',
      name:'阿依乃再?麦麦提',
     
      fid:'21',
      mid:'21p',
      pid:'',
      cid:[],
      bid:["31","32","33","34"],
      imgurl:"img/41.jpg",
      relation:"曾孙",
      record : ""
    },{
      id:'34',
      name:'阿依乃再?麦麦提',
     
      fid:'21',
      mid:'21p',
      pid:'34p',
      cid:[],
      bid:["31","32","33","34"],
      imgurl:"img/41.jpg",
      relation:"曾孙",
      record : ""
    },{
      id:'34p',
      name:'阿依乃再?麦麦提',
     
      fid:'',
      mid:'',
      pid:'34',
      cid:[],
      bid:["34p"],
      imgurl:"img/41.jpg",
      relation:"曾孙",
      record : ""
    }] 
  ];
var json = [
    [
        {
            "id": "43367819090701234",
            "name": "买买提",
            url:[{name :"1111",url :"http://www.baidu.com/"}],
            "fid": "0bd77cd0f19343dd9df08a6f7a90febd",
            "mid": "",
            "pid": "",
            "cid": [
                "43367819090701235",
                "43367819090701237"
            ],
            "bid": [
                "43367819090701234"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701234",
            "relation": "户主",
            "record": ""
        }
    ],
    [
        {
            "id": "43367819090701235",
            "name": "买一",
            url:[{name :"去百度",url :"http://www.baidu.com/"},{name :"去腾讯",url :"http://www.qq.com/"}],
            "fid": "43367819090701234",
            "mid": "",
            "pid": "",
            "cid": [
                "43367819090701239",
                "43367819090701238"
            ],
            "bid": [
                "43367819090701235",
                "43367819090701237"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701235",
            "relation": "儿子",
            "record": ""
        },
        {
            "id": "43367819090701237",
            "name": "买三",
           
            "fid": "43367819090701234",
            "mid": "",
            "pid": "",
            "cid": [],
            "bid": [
                "43367819090701235",
                "43367819090701237"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701237",
            "relation": "女儿",
            "record": ""
        }
    ],
    [
        {
            "id": "43367819090701238",
            "name": "买买五",
           
            "fid": "43367819090701235",
            "mid": "",
            "pid": "",
            "cid": [],
            "bid": [
                "43367819090701239",
                "43367819090701238"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701238",
            "relation": "儿子",
            "record": ""
        },
        {
            "id": "43367819090701239",
            "name": "买买四",
           
            "fid": "43367819090701235",
            "mid": "",
            "pid": "",
            "cid": [
                "43367819090701335",
                "43367819090701334",
                "43367819090681335",
                "43367819090721335",
                "43367819090651335",
                "43367819090701336"
            ],
            "bid": [
                "43367819090701239",
                "43367819090701238"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701239",
            "relation": "儿子",
            "record": ""
        }
    ],
    [
        {
            "id": "43367819090651335",
            "name": "",
           
            "fid": "43367819090701239",
            "mid": "",
            "pid": "",
            "cid": [],
            "bid": [
                "43367819090701335",
                "43367819090701334",
                "43367819090681335",
                "43367819090721335",
                "43367819090651335",
                "43367819090701336"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090651335",
            "relation": "表哥",
            "record": ""
        },
        {
            "id": "43367819090681335",
            "name": "",
           
            "fid": "43367819090701239",
            "mid": "",
            "pid": "",
            "cid": [],
            "bid": [
                "43367819090701335",
                "43367819090701334",
                "43367819090681335",
                "43367819090721335",
                "43367819090651335",
                "43367819090701336"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090681335",
            "relation": "同行业",
            "record": ""
        },
        {
            "id": "43367819090701334",
            "name": "热力",
           
            "fid": "43367819090701239",
            "mid": "",
            "pid": "",
            "cid": [
                "43367819090701365"
            ],
            "bid": [
                "43367819090701335",
                "43367819090701334",
                "43367819090681335",
                "43367819090721335",
                "43367819090651335",
                "43367819090701336"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701334",
            "relation": "户主",
            "record": ""
        },
        {
            "id": "43367819090701335",
            "name": "",
           
            "fid": "43367819090701239",
            "mid": "",
            "pid": "",
            "cid": [],
            "bid": [
                "43367819090701335",
                "43367819090701334",
                "43367819090681335",
                "43367819090721335",
                "43367819090651335",
                "43367819090701336"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701335",
            "relation": "儿子",
            "record": ""
        },
        {
            "id": "43367819090701336",
            "name": "",
           
            "fid": "43367819090701239",
            "mid": "",
            "pid": "",
            "cid": [],
            "bid": [
                "43367819090701335",
                "43367819090701334",
                "43367819090681335",
                "43367819090721335",
                "43367819090651335",
                "43367819090701336"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701336",
            "relation": "儿子",
            "record": ""
        },
        {
            "id": "43367819090721335",
            "name": "",
           
            "fid": "43367819090701239",
            "mid": "",
            "pid": "",
            "cid": [
                "43367819090701324"
            ],
            "bid": [
                "43367819090701335",
                "43367819090701334",
                "43367819090681335",
                "43367819090721335",
                "43367819090651335",
                "43367819090701336"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090721335",
            "relation": "邻居",
            "record": ""
        }
    ],
    [
        {
            "id": "43367819090701365",
            "name": "",
           
            "fid": "43367819090701334",
            "mid": "",
            "pid": "",
            "cid": [],
            "bid": [
                "43367819090701365"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701365",
            "relation": "女儿",
            "record": ""
        },
        {
            "id": "43367819090701324",
            "name": "",
           
            "fid": "43367819090721335",
            "mid": "",
            "pid": "",
            "cid": [
                "43367819090701236"
            ],
            "bid": [
                "43367819090701324"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701324",
            "relation": "表妹",
            "record": ""
        }
    ],
    [
        {
            "id": "43367819090701236",
            "name": "买二",
           
            "fid": "43367819090701324",
            "mid": "",
            "pid": "",
            "cid": [],
            "bid": [
                "43367819090701236"
            ],
            "imgurl": "http://192.168.0.191:8085/ITAP/servlet/back/TPckS?type=cxXP2&ZJHM=43367819090701236",
            "relation": "女儿",
            "record": ""
        }
    ]
];
var opt = {
  data : json,
  id : "genogram",
  coordX : 180,   //节点x轴间距
  coordY : 280,   //节点y轴间距
  selfH : 190,    //节点高度
  imgW : 100,      //图片宽高
  desc : "家谱aSasASasaSsAS说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明家谱说明",   //家谱说明
  collec : {
    name : "采集人采集人", //采集人
    time : "2016-6-30 15:38:40"
  },
  listener : function(obj,msg){
    // obj 点击对象, msg 对象携带的数据
    // alert(1)
  },
  menuTo :function(obj,id){
    console.log(obj.innerText,id);

    
    // location.href="http://www.baidu.com/";

  }
};
new Genogram(opt);
window.onload = function(){

var savepng = document.getElementById("savepng");
var canvas = document.getElementById("SvgjsSvg1001");
savepng.onclick = function(){
     // svgAsPngUri(canvas, null, function(uri) {
     //      png.innerHTML = '<img src="' + uri + '" />';
     //    });
     // $sandbox.find('.preview').html('<img src="' + uri + '" />');
    saveSvgAsPng(canvas, "name.png")

  };
}

</script> 
     
</body>  
</html> 